<!DOCTYPE html>
<html lang="en">
<head>
    <title>ConsoleJS Remote</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="Lib/bootstrap/css/bootstrap.min.css" rel="stylesheet" media="screen">
    <link href="Lib/bootstrap/css/bootstrap-responsive.min.css" rel="stylesheet">
    <link href="Lib/prettify/prettify.css" type="text/css" rel="stylesheet"/>

    <script src="Lib/jquery-1.8.3.min.js"></script>
    <script src="Lib/bootstrap/js/bootstrap.min.js"></script>
    <script src="Lib/prettify/prettify.js"></script>
    <script src="Lib/prettify/lang-css.js"></script>
    <script src="Lib/prettify/lang-tex.js"></script>
    <script src="/socket.io/socket.io.js"></script>

    <link href="UI/ConsoleUI.css" rel="stylesheet">
    <script src="UI/ConsoleUI.js"></script>
    <script src="UI/Room.js"></script>
    <script src="UI/RoomManager.js"></script>
    <script src="UI/SocketServer.js"></script>
</head>
<body onload="prettyPrint();">
<div id="main-wrapper">
    <div class="navbar navbar-inverse navbar-fixed-top">
        <div class="navbar-inner">
            <div class="container-fluid">
                <a class="brand" href="#">Console JS</a>
            </div>
        </div>
    </div>

    <div class="container-fluid">
        <div class="row-fluid">
            <div class="span2">
                <div class="well sidebar-nav">
                    <ul id="clientList" class="nav nav-list">
                        <li class="nav-header">Remote Client List</li>
                    </ul>
                </div>
                <div class="well sidebar-nav">
                    <ul class="nav nav-list">
                        <li class="nav-header">Connection Info</li>
                        <li><a id="connection"></a></li>
                    </ul>
                </div>
            </div>
            <div class="span10">
                <div class="btn-group">
                    <button class="btn btn-success">Send</button>
                    <button class="btn btn-warning">Ping</button>
                    <button class="btn btn-info">Window</button>
                    <button class="btn btn-info">Document</button>
                    <button class="btn btn-info">Body</button>
                    <button class="btn btn-info">Navigator</button>
                    <button class="btn btn-info">Location</button>
                    <button class="btn btn-info">History</button>
                    <button class="btn btn-info">Screen</button>
                    <button class="btn btn-info">Scripts</button>
                    <button class="btn btn-info">Styles</button>
                    <button class="btn btn-info">Cookie</button>
                    <button class="btn btn-warning">Clear</button>
                    <button class="btn btn-success">Reload</button>
                </div>
                <div class="input-append">
                    <textarea id="command" class="input-block-level" rows="2"></textarea>
                </div>
                <ul id="connectRooms" class="nav nav-tabs">
                </ul>
                <div id="connectRoomsContent" class="tab-content">
                </div>
            </div>
        </div>
    </div>
</div>
</body>
<script type="text/javascript">

    (function () {

        $('.btn').click(function () {
            var self = $(this),
                    cmd = '';

            switch (self.html().toLowerCase()) {
                case 'send':
                    cmd = $('#command').val();
                    $('#command').val('');
                    break;
                case 'ping':
                    cmd = '"ping..."';
                    break;

                case 'window':
                    cmd = 'console.dir(window)';
                    break;
                case 'document':
                    cmd = 'console.dir(document)';
                    break;
                case 'body':
                    cmd = 'console.dirxml(document.body)';
                    break;
                case 'navigator':
                    cmd = 'console.dir(window.navigator)';
                    break;
                case 'location':
                    cmd = 'console.dir(window.location)';
                    break;
                case 'history':
                    cmd = 'console.dir(window.history)';
                    break;
                case 'screen':
                    cmd = 'console.dir(window.screen)';
                    break;
                case 'scripts':
                    cmd = ' (function getScripts(){ ' +
                            '     var i = 0, scripts = document.scripts, length = scripts.length;' +
                            '     for(; i < length; i++){ ' +
                            '         console.dirxml(scripts[i]); ' +
                            '     }; ' +
                            '}())';
                    break;
                case 'styles':
                    cmd = ' (function getStyles(){ ' +
                            '     var i = 0, styles = document.getElementsByTagName("link"), length = styles.length;' +
                            '     for(; i < length; i++){ ' +
                            '         console.dirxml(styles[i]);' +
                            '      }; ' +
                            '}())';
                    break;
                case 'cookie':
                    cmd = 'console.log(document.cookie)';
                    break;

                case 'clear':
                    cmd = 'console.clear()';
                    break;
                case 'reload':
                    cmd = 'window.location.reload()';
                    break;
            }

            server.request(cmd);
        });

        $('#command').keypress(function (e) {
            if (e.keyCode == 13 && !e.shiftKey) {
                var data = $(this).val();
                if (data) {
                    server.request(data);
                    $(this).val('');
                }
                e.preventDefault();
            }
        });

        function sizing() {
            var wrapperHeight = $("#main-wrapper").height();
            var tabHeight = $("#connectRooms").height() || 0;
            var contentHeight = wrapperHeight - tabHeight - 200;
            $("#connectRoomsContent").height(contentHeight + "px");
        }

        $(document).ready(sizing);
        $(window).resize(sizing);

        var server = new SocketServer('http://localhost:8082');
        server.start();
    }());
</script>
</html>